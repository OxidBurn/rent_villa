---
name: Vitest Test Infrastructure
status: completed
created: 2025-10-30T17:15:07Z
updated: 2025-10-31T01:10:00Z
github: https://github.com/OxidBurn/rent_villa/issues/4
depends_on: [2]
parallel: false
conflicts_with: []
---

# Task: Vitest Test Infrastructure

## Description
Set up Vitest as the testing framework for the Next.js application, configure it to work with TypeScript and React components, create sample unit tests to validate the setup, and integrate testing into the CI pipeline.

## Acceptance Criteria
- [ ] Vitest and related dependencies installed (`vitest`, `@vitejs/plugin-react`, `jsdom`, `@testing-library/react`, `@testing-library/jest-dom`)
- [ ] Vitest configuration file created (`vitest.config.ts`)
- [ ] Test script added to `package.json` (`npm test`)
- [ ] Sample unit tests created for at least one component (e.g., home page)
- [ ] Tests run successfully in local development
- [ ] Coverage reporting configured
- [ ] CI workflow updated to run tests
- [ ] Test files follow naming convention (`*.test.tsx` or `*.spec.tsx`)

## Technical Details
**Implementation Approach:**
1. Install dependencies:
   ```bash
   npm install -D vitest @vitejs/plugin-react jsdom
   npm install -D @testing-library/react @testing-library/jest-dom @testing-library/user-event
   ```

2. Create `vitest.config.ts`:
   - Configure React plugin
   - Set up jsdom environment
   - Configure path aliases to match `tsconfig.json`
   - Enable globals for easier testing

3. Create sample tests:
   - Test home page component renders correctly
   - Test basic functionality
   - Demonstrate testing patterns for Server and Client Components

4. Update CI workflow:
   - Add test job to `.github/workflows/ci.yml`
   - Run `npm test` in CI pipeline

**Key Considerations:**
- Next.js 16 with React 19 requires compatible testing library versions
- Path aliases (`@/*`) must be configured in Vitest config
- Server Components require different testing approaches than Client Components
- Consider setting up test coverage thresholds
- Mock Next.js navigation and routing as needed

**Files Affected:**
- `package.json` (dependencies and scripts)
- `vitest.config.ts` (new file)
- `src/app/page.test.tsx` (new file - sample test)
- `.github/workflows/ci.yml` (update test job)
- Potentially `tsconfig.json` (if test-specific types needed)

## Dependencies
- [ ] Task 001 (GitHub Actions CI Workflow) must be completed
- [ ] CI workflow file must exist to be updated

## Effort Estimate
- Size: S (Small)
- Hours: 4-6 hours
- Parallel: false

## Definition of Done
- [ ] Code implemented - Vitest configured and sample tests written
- [ ] Tests written and passing - All sample tests pass locally and in CI
- [ ] Documentation updated - Testing guide added to docs
- [ ] Code reviewed - PR reviewed with focus on test patterns
- [ ] Deployed to staging - CI runs tests on test PR successfully
